Давайте представим, что у вас есть определенное **время**, которое вы хотели бы отобразить на своем сайте. Время хранится в формате *вашей* таймзоны. Конечно, вы можете показывать его с явным указание часового пояса, скажем так - **3:00 PM Eastern Standard Time**. В таком случае каждый посетить вашего сайте будет вынужден вручную конвертировать время с поправкой на свой часовой пояс, ну или использовать этот отличный ресурс - [Every Time Zone]([1])

Но разработчик ведь может позаботиться о пользователе и локализовать время в соответствии с его таймзоной, избавив тем самым от необходимости делать это самостоятельно. Тем более, что web-разработчик имеет для этого отличное средство - JavaScript.

Я уверен, что существует ни один способ, чтобы сделать это. Недавно мне пришлось столкнулся с подобной задачей на одном своем новом проекте. И я решил перенять опыт по локализации дат у ребят из [ShopTalk]([2]).

### Библиотеки

[Moment.js]([3]) и [Moment Timezone]([4]) - отличные инструменты для решения задач, связанных с локализацией дат. Вы смело можете использовать их для различных манипуляций, связанных с датами. Например, "32 minutes ago", "12 de Agosto de 2015".

Еще один важный момент заключается в том, что мы должны автоматически определять текущую таймзону пользователя. К счастью, для это есть [отличное средство]([5]).

Итак, мы будем использовать:
* jstz.js
* moment.js
* moment-timezone.js

### Шаг 1: Получение таймзоны 

После получения таймзоны, мы можем легко сохранить ее в localStorage. Этим мы обеспечим легкий доступ к сохраненным данным.

    if (!sessionStorage.getItem('timezone')) {
        var tz = jstz.determine() || 'UTC';
        sessionStorage.setItem('timezone', tz.name());
    }
    var currTz = sessionStorage.getItem('timezone');

### Шаг 2: Получение значения времени

Moment работает с датой/временем в формате [UTC]([6]):

    2015-08-12T14:30Z

Используя Moment, мы можем легко изменять формат дат. Давайте рассмотрим небольшой пример. По-умолчанию Moment создает объект, основанный на текущей дате, который мы преобразуем в строку нужного формата.

    var date = moment().format("YYYY-MM-DD");
    
Затем добавим к получившейся строке время:

    var stamp = date + "T" + theTime + "Z";

И, наконец, преобразуем строку в новый объект Moment:

    var momentTime = moment(stamp);

### Шаг 3: Локализация времени

Теперь мы можем приступить к локализации времени, используя Moment Timezone:

    var tzTime = momentTime.tz(currTz);
    
И, конечно же, отформатируем получившееся значение для более удобного отображения:

    var formattedTime = tzTime.format('h:mm A');
 
### Шаг 4: Использование

Ну что же, теперь мы можем использовать описанный подход на любом сайте. Вместе с отформатированным временем вы можете отображать и текущую таймзону. Если же определение таймзоны по каким-то причинам завершилось неудачей, то время отобразится в UTC формате.

    output.textContent = "Time in " + currTz + ": " + formattedTime;

 [1]: http://everytimezone.com/
 [2]: http://shoptalkshow.com/
 [3]: http://momentjs.com/
 [4]: http://momentjs.com/timezone/
 [5]: https://bitbucket.org/pellepim/jstimezonedetect
 [6]: https://en.wikipedia.org/wiki/Coordinated_Universal_Time